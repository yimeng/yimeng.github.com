<!doctype html><html lang=zh-cn><title>家庭电量可观测性 | 出租窝</title>
<meta charset=utf-8><meta name=generator content="Hugo 0.125.3"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://git.yimeng.ch/post/2022/metts2/><link rel=alternate type=application/rss+xml href title=出租窝><link rel=stylesheet href=https://git.yimeng.ch/css/theme.css><link rel=stylesheet href=https://git.yimeng.ch/css/classes.css><header class=dark><h2><a href=https://git.yimeng.ch/>出租窝</a></h2><nav></nav></header><article><header><h1><a href=https://git.yimeng.ch/post/2022/metts2/>家庭电量可观测性</a></h1><p class=meta><time datetime=2022-05-03T09:19:00+08:00>May 03, 2022</time></p></header><h1 id=家庭电量可观测性硬件篇>家庭电量可观测性（硬件篇）</h1><h2 id=硬件选择>硬件选择</h2><p>上一篇说完硬件的选择原则，这篇就开始说说硬件之间的连接部分。</p><p>其实说白了就是下图中的蓝色部分，而蓝色部分最重要的两个就是电能表和协议转换器了。</p><p>电能表</p><p>协议转换器</p><h2 id=总体架构>总体架构</h2><h2 id=连接方式>连接方式</h2><h3 id=电能表与空开>电能表与空开</h3><p>先说电表，大概是这个样子的。把电量表接到了空开的前面是因为，外面还有一个电表和空开。这样即使我家跳闸断电，只要外面的空开没有断。电能表还是可以工作的，配合检测端的UPS，是可以作为停电监测用的。（全停电冰箱里的肉杀伤力极强，别问我怎么知道的）</p><h3 id=转换器供电连接>转换器供电连接</h3><p>然后再说RS486和供电部分，这个转换器端用RJ45网口接入，通过他配的线集成了RS485+供电/网线的功能。</p><p><img src=https://img.alicdn.com/imgextra/i3/702772642/O1CN01Lxus5h1VO4yk2qRl9_!!702772642.jpg alt=img></p><p>可以看到供电部分使用2和3针脚。找了一根没用的USB线，把其中的1,4针脚接出来。</p><p><img src=http://pic.chenym.net/blog/image-20220519140619019.png alt=image-20220519140619019></p><p>光猫的USB1,4针脚，接入转换器的2,3针脚。完成供电。</p><p><img src=http://pic.chenym.net/blog/image-20220519140710009.png alt=image-20220519140710009></p><h3 id=转换器的数据连接>转换器的数据连接</h3><p>转换器的1,4针脚，接入电能表的数据AB接口，完成数据的接入。</p><p><img src=http://pic.chenym.net/blog/image-20220519141228880.png alt=image-20220519141228880></p><p>转换器与电脑之前的网线连接：</p><p><img src=http://pic.chenym.net/blog/ammeter.png alt=img></p><p><img src=http://pic.chenym.net/blog/image-20220519141800455.png alt=image-20220519141800455></p><h3 id=电脑访问转换器页面>电脑访问转换器页面</h3><p>剩下就是很简单的插上网线，转换器会获取到DHCP地址。通过web页面进行访问即可。剩下的就是如何通过软件来获取信息了。</p><p><img src=http://pic.chenym.net/blog/image-20220519141335968.png alt=image-20220519141335968></p><h2 id=后记>后记</h2><p>这部分最重要的要就是安全，因为牵涉到强电改造。一定不要在带电的情况下操作。还有就是注意好正负极，防止短路。</p><p>数据连接部分主要注意，线一定要弄牢。485的线没有任何提示你是否已经牢固，是否有松动的情况。这种情况最不好排查了。也是玩硬件里最头疼的一部分。毕竟不像网线那样不牢固会丢包，会降速，能从指示灯上看到。</p><p>还有一点就是 提前规划好连接，做好一些准备。比如我这个电量表买回来，才发现火线的供电确实有了。但是忘记还要有个零线才能用，所以就稍微飞了一根零线回程。还好不耽误用，但是如果是其它不能改造的地方就比较尴尬了。</p></article></html>